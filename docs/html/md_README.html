<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>digest: Digest</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">digest
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Digest</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a>C++ library which supports various minimizer schemes for digestion of DNA sequences <br  />
</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Implementation (Most of the documentation is in the code)</h1>
<p>Supports Mod Minimizers, Window Minimizers, and Syncmers <br  />
</p>
<p>Uses the cyclic or hash provided by <a href="https://github.com/bcgsc/ntHash">ntHash</a>. For now I just downloaded the essential files off their github and compiled it myself but I may change how I link in ntHash in the future. <br  />
</p>
<p>Tests were written using the <a href="https://github.com/catchorg/Catch2">Catch2</a> unit testing framework. <br  />
</p>
<p>As ntHash only hashes ACTG characters, this library can also only hash ACTG characters. Any kmer that contains a non-ACTG character will be skipped over, for example is the kmer size is 4, and the sequence is ACCGNATTGC, only ACCG, ATTG, and TTGC will be hashed and considered for being a minimizer. <br  />
</p>
<p>Mod Minimzer classifies a kmer as a minimizer if the hash of the kmer is congruent to the user specified value in the user specified mod-space. <br  />
</p>
<p>Window Minimizer classifies a kmer as a minimizer if it is the smallest in the user specifed large window, using rightmost kmer to break ties. <br  />
</p>
<p>Syncmer classifies a large window as a minimizer if its smallest value is equal to the value of the hashes of the leftmost or rightmost kmer in the window (doesn't care if the smallest hash value is not unique). Because of how the large window is defined and how this library handles skipping over non-ACTG characters, if your sequence has non-ACTG characters, it is possible for this large window to have varying lengths in terms of number of characters. <br  />
</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Install</h1>
<p>We use <a href="https://mesonbuild.com">Meson</a>. (Very) old version will not work.</p>
<p>PREFIX is an absolute path to install location. If excluded, will install to system libraries. </p><div class="fragment"><div class="line">meson setup --prefix=PREFIX --buildtype=release build</div>
<div class="line">meson install -C build</div>
</div><!-- fragment --><p> This will generate <code>include</code> and <code>lib</code> folders.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Usage</h1>
<ul>
<li>Headers at <code>#include &lt;digest/___.hpp&gt;</code></li>
<li>Classes are in <code>digest</code> namespace</li>
<li>example compile: <code>g++ file.cpp -IPREFIX/include -LPREFIX/lib -ldigest</code></li>
<li>may need <code>std=c++17</code></li>
<li>ntHash does not support <code>large_window &lt; 4</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Example</h1>
<div class="fragment"><div class="line">digest::WindowMin&lt;digest::ds::Naive&lt;8&gt;&gt; wm(str, 16, 8);</div>
<div class="line">std::vector&lt;size_t&gt; temp;</div>
<div class="line">wm.roll_minimizer(100000, temp);</div>
</div><!-- fragment --><p> Example snippet to collect up to 100000 indices of minimizers. A vector must be passed in, which will be appended to. Each WindowMin / Syncmer object is templated by the algorithm / data structure to find minimizers.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Selecting the correct <code>data_structure</code></h1>
<p>our general guidelines:</p><ul>
<li>for <code>large_window</code> &lt; 12, use Naive</li>
<li>for 12 &lt;= <code>large_window</code> &lt;= 16 use SegmentTree</li>
<li>for <code>large_window</code> &gt; 16 use Naive2</li>
</ul>
<p>adaptive performs at worst about 10% slower than best <br  />
 adaptive64 performs at worst about 100% slower than best</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Contributing</h1>
<p>run </p><div class="fragment"><div class="line">ninja clang-format</div>
<div class="line">ninja clang-tidy</div>
<div class="line">ninja docs</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Benchmark / Tests</h1>
<div class="fragment"><div class="line">meson setup build</div>
<div class="line">cd build &amp;&amp; meson compile</div>
</div><!-- fragment --><p> this will generate proper executables for benchmark/testing </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
